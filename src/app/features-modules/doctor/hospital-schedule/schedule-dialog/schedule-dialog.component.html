<app-dialog-header [headingText]="editData" [iconClass]="'fa-solid fa-business-time'"
  (closeDialog)="dialogRef.close(true)"></app-dialog-header>
<div class="px-6 md:px-10 py-4 md:py-6">
  <form [formGroup]="form" class="flex">
    <div class="form-row" formArrayName="appointments">
      <div *ngFor="let appointment of days.controls; let i = index" class="-mx-3 flex flex-wrap form-row-item">
        <ng-container [formGroupName]="i">

          <!-- <div
            class="w-full px-3"
            [ngClass]="i == 0 ? 'sm:w-[33%]' : 'sm:w-[28%]'"
          >
            <div class="mb-5">
              <label
                for="startTime{{ i }}"
                class="mb-2 block font-medium text-[14px] text-[#07074D]"
              >
                Start time
              </label>
              <input
                formControlName="startTime"
                type="time"
                [id]="'startTime' + i"
                class="form_input"
              />
              <p
                *ngIf="
                  formSubmitted &&
                  form
                    .get('appointments.' + i + '.startTime')
                    ?.hasError('required')
                "
                class="text-red-600 text-sm"
              >
                Start time is required!
              </p>
            </div>
          </div>
          <div
            class="w-full px-3"
            [ngClass]="i == 0 ? 'sm:w-[33%]' : 'sm:w-[28%]'"
          >
            <div class="mb-5">
              <label
                for="endTime{{ i }}"
                class="mb-2 block font-medium text-[14px] text-[#07074D]"
              >
                End time
              </label>
              <input
                formControlName="endTime"
                type="time"
                [id]="'endTime' + i"
                class="form_input"
              />
              <p
                *ngIf="
                  formSubmitted &&
                  form
                    .get('appointments.' + i + '.endTime')
                    ?.hasError('required')
                "
                class="text-red-600 text-sm"
              >
                End time is required!
              </p>
            </div>
          </div> -->





          <div class="flex gap-3">
            <div class="max-w-[100px]">
              <div (click)="pickerA.open()">
                <label for="numberOfPatients{{ i }}" class="mb-2 block font-medium text-[14px] text-[#07074D]">
                  Start time
                </label>
                <input formControlName="startTime" matInput name="selected_time_A" class="form_input"
                  [ngxMatTimepicker]="pickerA" [format]="24" placeholder="4:00 PM" readonly />
              </div>
              <ngx-mat-timepicker timepickerClass="picker" #pickerA dottedMinutesInGap
                enableKeyboardInput></ngx-mat-timepicker>
            </div>

            <div class="max-w-[100px]">
              <div (click)="pickerA.open()">
                <label for="numberOfPatients{{ i }}" class="mb-2 block font-medium text-[14px] text-[#07074D]">
                  End time
                </label>
                <input formControlName="endTime" matInput name="selected_time_B" class="form_input"
                  [ngxMatTimepicker]="pickerB" [format]="24" placeholder="4:00 PM" readonly />
              </div>
              <ngx-mat-timepicker timepickerClass="picker" #pickerB dottedMinutesInGap
                enableKeyboardInput></ngx-mat-timepicker>
            </div>
            <div class="min-w-[100px] px-3">
              <div class="mb-5">
                <label for="numberOfPatients{{ i }}" class="mb-2 block font-medium text-[14px] text-[#07074D]">
                  Number of patients
                </label>
                <input formControlName="noOfPatients" placeholder="e.x: 50" type="number" [id]="'noOfPatients' + i"
                  class="form_input" />
                <p *ngIf="
                    formSubmitted &&
                    form.get('appointments.' + i + '.noOfPatients')?.value == '0' || formSubmitted &&
                    form.get('appointments.' + i + '.noOfPatients')?.hasError('required')
                  " class="text-red-600 text-sm">
                  Number of patients is required!
                </p>
                <p *ngIf="form.get('appointments.' + i + '.noOfPatients')?.hasError('pattern')
              " class="text-red-600 text-sm">
                  Patient number should be grater than 0!
                </p>
              </div>
            </div>
          </div>


          <div class="flex items-center" [ngClass]="i > 0 ? 'sm:w-[10%]' : 'hidden '">
            <button class="btn-secondary" type="button" (click)="removeAppointmentRow(i)">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>
        </ng-container>
      </div>
    </div>
  </form>

  <div class="flex w-full gap-2 sm:gap-4 flex-wrap sm:flex-nowrap mt-5">
    <button class="btn-secondary-light border border-secondary-dark w-full md:w-fit mr-0" type="button"
      (click)="addAppointmentRow()">
      Add more
    </button>

    <button class="btn-secondary md:mr-4 w-full md:w-fit" type="button" (click)="submit()">
      {{editData.edit ? 'Update Session' : 'Save Session' }}
    </button>
  </div>
</div>